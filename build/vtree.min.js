!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?exports.Vtree=e(require("jquery")):t.Vtree=e(t.jquery)}(this,function(t){return function(t){function e(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return t[o].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){var o,i,r,s,a;o=n(2),i=n(3),r=n(4),s=n(6),t.exports=a=function(){function t(){}return t.DOM=r,t.initNodes=function(){return this._launcher().launch(this.config()),this._launcher().createViewsTree()},t.initNodesAsync=function(){return AsyncFn.addToCallQueue(function(t){return function(){var e;return e=new o.Deferred,AsyncFn.setImmediate(function(){return t.initNodes(),e.resolve()}),e.promise()}}(this))},t.onNodeInit=function(t){return this.hooks().onInit(t)},t.getInitCallbacks=function(){return this.hooks().onInitCallbacks()},t.onNodeUnload=function(t){return this.hooks().onUnload(t)},t.getUnloadCallbacks=function(){return this.hooks().onUnloadCallbacks()},t.configure=function(t){var e,n,o;n=[];for(e in t)o=t[e],n.push(this.config()[e]=o);return n},t.config=function(){return null!=this._config?this._config:this._config=new i},t.hooks=function(){return this._launcher().hooks()},t._launcher=function(){return null!=this.__launcher?this.__launcher:this.__launcher=s},t}(),window.Vtree=a},function(e,n){e.exports=t},function(t,e){var n;t.exports=n=function(){function t(){}return t.prototype.viewSelector="[data-view]",t.prototype.componentSelector="[data-component]",t.prototype.selector="[data-component], [data-view]",t.prototype.namespacePattern=/(.+)#(.+)/,t.prototype.isComponentIndex=function(t){return null!=t.data("component")},t.prototype.nodeUnderscoredName=function(t){return this.isComponentIndex(t)?t.data("component"):t.data("view")||""},t.prototype.isStandAlone=function(t){return!this.isComponentIndex(t)&&this.namespacePattern.test(this.nodeUnderscoredName(t))},t.prototype.extractStandAloneNodeData=function(t){var e,n,o,i;return i=this.nodeUnderscoredName(t).match(this.namespacePattern),e=i[0],n=i[1],o=i[2],[n,o]},t.prototype.extractComponentIndexNodeData=function(t){var e,n,o,i;return i=this.nodeUnderscoredName(t).match(this.namespacePattern),e=i[0],o=i[1],n=i[2],[o,n]},t}()},function(t,e,n){var o,i,r;o=n(2),i=n(5),t.exports=r=function(){function t(){}return t.html=function(t,e){return t.children().each(function(t,e){return o(e).remove()}),t.html(e),t.trigger("refresh")},t.append=function(t,e){return t.append(e),t.trigger("refresh")},t.prepend=function(t,e){return t.prepend(e),t.trigger("refresh")},t.before=function(t,e){return t.before(e),t.parent().trigger("refresh")},t.after=function(t,e){return t.after(e),t.parent().trigger("refresh")},t.remove=function(t){return t.remove()},t.htmlAsync=function(t,e){return i.addToCallQueue(function(){var n;return n=new o.Deferred,i.setImmediate(function(){return t.children().each(function(t,e){return o(e).remove()}),t.html(e),t.trigger("refresh"),n.resolve()}),n.promise()})},t.appendAsync=function(t,e){return i.addToCallQueue(function(){var n;return n=new o.Deferred,i.setImmediate(function(){return t.append(e),t.trigger("refresh"),n.resolve()}),n.promise()})},t.prependAsync=function(t,e){return i.addToCallQueue(function(){var n;return n=new o.Deferred,i.setImmediate(function(){return t.prepend(e),t.trigger("refresh"),n.resolve()}),n.promise()})},t.beforeAsync=function(t,e){return i.addToCallQueue(function(){var n;return n=new o.Deferred,i.setImmediate(function(){return t.before(e),t.parent().trigger("refresh"),n.resolve()}),n.promise()})},t.afterAsync=function(t,e){return i.addToCallQueue(function(){var n;return n=new o.Deferred,i.setImmediate(function(){return t.after(e),t.parent().trigger("refresh"),n.resolve()}),n.promise()})},t}()},function(t,e,n){!function(e,o){t.exports=o(n(2))}(this,function(t){return function(t){function e(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return t[o].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){var o;o=n(2),t.exports=window.AsyncFn=function(){function t(t){this.dfd=new o.Deferred,this.fn=t}return t.prototype.done=function(t){if(this.callback=t,this.isCalled)return this.callback()},t.prototype.call=function(){if(!this.isCalled)return this.fn().always(function(t){return function(){if(t.isCalled=!0,t.dfd.resolve(),t.callback)return t.callback()}}(this))},t.addToCallQueue=function(e){var n;return n=new t(e),null!=this.currentFn?this.currentFn.done(function(){return n.call()}):n.call(),this.currentFn=n},t.setImmediate=function(){var t,e,n,o;return e={},o=e,t=Math.random(),n=function(n){var o;if(n.data.toString()===t.toString())return e=e.next,o=e.func,delete e.func,o()},window.addEventListener&&window.postMessage?(window.addEventListener("message",n,!1),function(e){return o=o.next={func:e},window.postMessage(t,"*")}):function(t){return setTimeout(t,0)}}(),t}()},function(e,n){e.exports=t}])})},function(t,e,n){var o,i,r,s;o=n(2),s=n(7),i=n(10),t.exports=r=function(){function t(){}return t.launch=function(t){return this.initTreeManager(t),this.initRemoveEvent(),this.initRefreshEvent(t)},t.initTreeManager=function(t){return this.treeManager=new s(t,this.hooks())},t.initRemoveEvent=function(){var t;return null!=(t=o.event.special).remove?t.remove:t.remove={remove:function(t){var e,n;return n=this,e={type:"remove",data:t.data,currentTarget:n},t.handler(e)}}},t.initRefreshEvent=function(t){var e;if(!this.isRefreshEventInitialized)return this.isRefreshEventInitialized=!0,e=function(e){return function(n){var i,r,s;for(n.stopPropagation(),i=o(n.currentTarget).closest(t.selector),s=i.data("vtree-node-id");i.length&&!s;)i=i.parent().closest(t.selector),s=i.data("vtree-node-id");if(s)return r=e.treeManager.nodesCache.getById(s),e.treeManager.refresh(r)}}(this),o("body").on("refresh",e),o("body").on("refresh","*",e)},t.createViewsTree=function(){return this.treeManager.createTree()},t.hooks=function(){return null!=this._hooks?this._hooks:null!=this._hooks?this._hooks:this._hooks=new i},t}()},function(t,e,n){var o,i,r,s,a,u;o=n(2),a=n(8),r=n(9),s=n(11),i=n(10),t.exports=u=function(){function t(t,e){if(this.config=t,this.launcherHooks=e,null==this.config)throw new Error("Config is required");if(null==this.launcherHooks)throw new Error("Launcher hooks are required");this.initNodeHooks(),this.isInitializing=!1,this.initialNodes=[],this.nodesCache=new a}return t.prototype.initNodeHooks=function(){return this.hooks=new i,this.hooks.onInit(this.addNodeIdToElData),this.hooks.onInit(function(t){return function(e){return t.addRemoveEventHandlerToEl(e)}}(this)),this.hooks.onActivation(function(t){return function(e){return t.addNodeWrapper(e)}}(this)),this.hooks.onUnload(this.unloadNode),this.hooks.onUnload(this.deleteNodeWrapper)},t.prototype.createTree=function(){return this.isInitializing=!0,this.setInitialNodes(),this.setParentsForInitialNodes(),this.setChildrenForInitialNodes(),this.activateInitialNodes(),this.isInitializing=!1},t.prototype.setInitialNodes=function(){var t,e,n,i,s,a;for(t=o(this.config.selector),this.initialNodes=[],a=[],e=n=0,s=t.length;0<=s?n<s:n>s;e=0<=s?++n:--n)i=new r(t.eq(e),this.hooks),this.nodesCache.add(i),a.push(this.initialNodes.push(i));return a},t.prototype.setParentsForInitialNodes=function(){return this.setParentsForNodes(this.initialNodes)},t.prototype.setChildrenForInitialNodes=function(){return this.setChildrenForNodes(this.initialNodes)},t.prototype.setParentsForNodes=function(t){var e,n,o,i,r,s;for(s=[],n=0,o=t.length;n<o;n++)i=t[n],e=i.$el.parent().closest(this.config.selector),0===e.length?s.push(this.nodesCache.addAsRoot(i)):(r=e.data("vtree-node-id"),s.push(i.parent=this.nodesCache.getById(r)));return s},t.prototype.setChildrenForNodes=function(t){var e,n,o,i,r,s;if(t.length){for(s=[],e=n=i=t.length-1;i<=0?n<=0:n>=0;e=i<=0?++n:--n)o=t[e],s.push(null!=(r=o.parent)?r.prependChild(o):void 0);return s}},t.prototype.activateInitialNodes=function(){return this.activateRootNodes(this.initialNodes)},t.prototype.activateRootNodes=function(t){var e,n,o,i,r;for(r=this.nodesCache.showRootNodes(),i=[],e=0,n=r.length;e<n;e++)o=r[e],i.push(this.activateNode(o));return i},t.prototype.activateNode=function(t){var e,n,o,i,r;for(t.activate(),i=t.children,r=[],n=0,o=i.length;n<o;n++)e=i[n],r.push(this.activateNode(e));return r},t.prototype.removeNode=function(t){if(!t.isRemoved())return t.parent&&t.parent.removeChild(t),this.removeChildNodes(t),t.remove(),this.nodesCache.removeById(t.id)},t.prototype.removeChildNodes=function(t){var e,n,o,i,r;for(i=t.children,r=[],n=0,o=i.length;n<o;n++)e=i[n],this.removeChildNodes(e),e.remove(),r.push(this.nodesCache.removeById(e.id));return r},t.prototype.refresh=function(t){var e,n,o,i,s,a,u,d,c,h;if(this.isInitializing)throw new Error("Vtree: You can't start initializing new nodes while current nodes are still initializing.\nPlease modify DOM asynchronously in such cases (use Vtree.DOM.htmlAsync, Vtree.DOM.appendAsync, etc).\nThis will guarantee that existing tree is completely initialized.");for(this.isInitializing=!0,n=t.$el.find(this.config.selector),u=[t],o=i=0,h=n.length;0<=h?i<h:i>h;o=0<=h?++i:--i)e=n.eq(o),(c=e.data("vtree-node-id"))?d=this.nodesCache.getById(c):(d=new r(e,this.hooks),this.nodesCache.add(d)),u.push(d);for(s=0,a=u.length;s<a;s++)d=u[s],d.children.length=0;return this.setParentsForNodes(u),this.setChildrenForNodes(u),this.activateNode(t),this.isInitializing=!1},t.prototype.addNodeIdToElData=function(t){return t.$el.data("vtree-node-id",t.id)},t.prototype.addRemoveEventHandlerToEl=function(t){return t.$el.on("remove",function(e){return function(){return e.removeNode(t)}}(this))},t.prototype.addNodeWrapper=function(t){return t.nodeWrapper=new s(t,this.config,this.launcherHooks)},t.prototype.unloadNode=function(t){var e;return null!=(e=t.nodeWrapper)&&"function"==typeof e.unload?e.unload():void 0},t.prototype.deleteNodeWrapper=function(t){return delete t.nodeWrapper},t}()},function(t,e){var n;t.exports=n=function(){function t(){this.nodes={},this.rootNodes=[]}return t.prototype.show=function(){return this.nodes},t.prototype.showRootNodes=function(){return this.rootNodes},t.prototype.add=function(t){return this.nodes[t.id]=t},t.prototype.addAsRoot=function(t){if(null==this.nodes[t.id])throw new Error("Trying to add node as root, but node is not cached previously");return this.rootNodes.push(t)},t.prototype.getById=function(t){return this.nodes[t]},t.prototype.removeById=function(t){var e;return(e=this.rootNodes.indexOf(this.nodes[t]))!==-1&&this.rootNodes.splice(e,1),delete this.nodes[t]},t.prototype.clear=function(){return this.nodes={},this.rootNodes=[]},t}()},function(t,e,n){var o,i;o=n(10),t.exports=i=function(){function t(t,n){this.$el=t,this.hooks=n||new o,this.el=this.$el[0],this.id="nodeId"+e,this.parent=null,this.children=[],e++,this.init()}var e;return e=1,t.prototype.setParent=function(t){return this.parent=t},t.prototype.prependChild=function(t){return this.children.unshift(t)},t.prototype.appendChild=function(t){return this.children.push(t)},t.prototype.removeChild=function(t){var e;if((e=this.children.indexOf(t))!==-1)return this.children.splice(e,1)},t.prototype.init=function(){return this.hooks.init(this)},t.prototype.activate=function(){if(!this.isActivated())return this.setAsActivated(),this.hooks.activate(this)},t.prototype.remove=function(){if(!this.isRemoved())return this.setAsRemoved(),this.isActivated()?this.unload():void 0},t.prototype.unload=function(){return this.hooks.unload(this),this.setAsNotActivated()},t.prototype.setAsActivated=function(){return this._isActivated=!0},t.prototype.setAsNotActivated=function(){return this._isActivated=!1},t.prototype.isActivated=function(){return null!=this._isActivated?this._isActivated:this._isActivated=!1},t.prototype.setAsRemoved=function(){return this._isRemoved=!0},t.prototype.isRemoved=function(){return null!=this._isRemoved?this._isRemoved:this._isRemoved=!1},t}()},function(t,e){var n,o=[].slice;t.exports=n=function(){function t(){}return t.prototype.onInit=function(t){return this.onInitCallbacks().push(t)},t.prototype.onInitCallbacks=function(){return null!=this._onInitCallbacks?this._onInitCallbacks:this._onInitCallbacks=[]},t.prototype.init=function(){var t,e,n,i,r,s;for(t=1<=arguments.length?o.call(arguments,0):[],r=this.onInitCallbacks(),s=[],n=0,i=r.length;n<i;n++)e=r[n],s.push(e.apply(null,t));return s},t.prototype.onActivation=function(t){return this.onActivationCallbacks().push(t)},t.prototype.onActivationCallbacks=function(){return null!=this._onActivationCallbacks?this._onActivationCallbacks:this._onActivationCallbacks=[]},t.prototype.activate=function(){var t,e,n,i,r,s;for(t=1<=arguments.length?o.call(arguments,0):[],r=this.onActivationCallbacks(),s=[],n=0,i=r.length;n<i;n++)e=r[n],s.push(e.apply(null,t));return s},t.prototype.onUnload=function(t){return this.onUnloadCallbacks().push(t)},t.prototype.onUnloadCallbacks=function(){return null!=this._onUnloadCallbacks?this._onUnloadCallbacks:this._onUnloadCallbacks=[]},t.prototype.unload=function(){var t,e,n,i,r,s;for(t=1<=arguments.length?o.call(arguments,0):[],r=this.onUnloadCallbacks(),s=[],n=0,i=r.length;n<i;n++)e=r[n],s.push(e.apply(null,t));return s},t.prototype._reset=function(){return this._onInitCallbacks=[],this._onActivationCallbacks=[],this._onUnloadCallbacks=[]},t}()},function(t,e,n){var o,i,r;o=n(2),i=n(12),t.exports=r=function(){function t(t,e,o){if(this.node=t,this.config=e,this.launcherHooks=o,null==this.config)throw new Error("Config is required");if(null==this.launcherHooks)throw new Error("Launcher hooks are required");this.$el=this.node.$el,this.el=this.node.el,this.isComponentIndex()&&n++,this.identifyNodeAttributes(),this.initNodeDataObject()}var e,n;return n=0,e="semarf",t.prototype.identifyNodeAttributes=function(){var t;return this.isStandAlone()?(t=this.config.extractStandAloneNodeData(this.$el),this.namespaceName=t[0],this.nodeName=t[1],t):(this.namespaceName=this.component().namespace,this.nodeName=this.isComponentIndex()?"index":this.nodeUnderscoredName())},t.prototype.initNodeDataObject=function(){var t;return this.nodeData=this.initNodeData(),null!=(t=this._hooks())&&"function"==typeof t.init?t.init(this.nodeData):void 0},t.prototype.initNodeData=function(){var t,e,n,o,r,s;return o=this.namespaceName,n=this._camelize(this.namespaceName),this.isStandAlone()?(e=null,t=null):(e=this.component().name,t=this._camelize(e)),new i({el:this.el,$el:this.$el,isStandAlone:this.isStandAlone(),isComponentIndex:this.isComponentIndex(),isComponentPart:!this.isStandAlone(),componentId:this.isStandAlone()?null:this.component().id,componentIndexNode:(null!=(r=this.componentIndexNode())&&null!=(s=r.nodeWrapper)?s.nodeData:void 0)||null,nodeName:this._camelize(this.nodeName),nodeNameUnderscored:this.nodeName,componentName:t,componentNameUnderscored:e,namespaceName:n,namespaceNameUnderscored:o})},t.prototype.unload=function(){var t;return null!=(t=this._hooks())&&"function"==typeof t.unload&&t.unload(this.nodeData),delete this.nodeData,delete this.node},t.prototype.isStandAlone=function(){return null!=this._isStandAlone?this._isStandAlone:this._isStandAlone=this.config.isStandAlone(this.$el)},t.prototype.component=function(){var t,o,i;return null!=this._component?this._component:this._component=this.isComponentIndex()?(i=this.config.extractComponentIndexNodeData(this.$el),o=i[0],t=i[1],i,{namespace:o,name:t,id:n,node:this.node}):null!=this.node.parent?this.node.parent.nodeWrapper.component():{namespace:e,name:e,id:0,node:this.node}},t.prototype.componentIndexNode=function(){return null!=this._componentIndexNode?this._componentIndexNode:this._componentIndexNode=this.isStandAlone()||this.isComponentIndex()?null:this.component().node},t.prototype.isComponentIndex=function(){return null!=this._isComponentIndex?this._isComponentIndex:this._isComponentIndex=this.config.isComponentIndex(this.$el)},t.prototype.nodeUnderscoredName=function(){return null!=this._nodeUnderscoredName?this._nodeUnderscoredName:this._nodeUnderscoredName=this.config.nodeUnderscoredName(this.$el)},t.prototype._hooks=function(){return this.launcherHooks},t.prototype._camelize=function(t){return t.replace(/(?:^|[-_])(\w)/g,function(t,e){return e?e.toUpperCase():""})},t}()},function(t,e){var n;t.exports=n=function(){function t(t){var e,n;for(e in t)n=t[e],this[e]=n;this.data={}}return t.prototype.el=null,t.prototype.$el=null,t.prototype.isComponentIndex=null,t.prototype.isComponentPart=null,t.prototype.isStandAlone=null,t.prototype.componentId=null,t.prototype.componentIndexNode=null,t.prototype.nodeName=null,t.prototype.componentName=null,t.prototype.namespaceName=null,t.prototype.nodeNameUnderscored=null,t.prototype.componentNameUnderscored=null,t.prototype.namespaceNameUnderscored=null,t.prototype.setData=function(t,e){return this.data[t]=e},t.prototype.getData=function(t){return this.data[t]},t}()}])});
//# sourceMappingURL=vtree.min.js.map